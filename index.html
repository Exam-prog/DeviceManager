<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í†µí•© ê´€ë¦¬ ëŒ€ì¥</title>
    <!-- Tailwind CSS CDN ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons ë¡œë“œ -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Inter í°íŠ¸ ì‚¬ìš© ì„¤ì • ë° ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb;
            color: #1f2937;
        }
        /* ìŠ¤í¬ë¡¤ë°” ì»¤ìŠ¤í„°ë§ˆì´ì§• (ì„ íƒ ì‚¬í•­) */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #d1d5db;
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background-color: #f3f4f6;
        }
        /* Hidden input label styling */
        .input-label-style {
            @apply block text-sm font-medium text-gray-700 mb-1;
        }
        /* Input styling */
        .input-field-style {
            @apply w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition-shadow;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <!-- ì œëª© ë° ì„¤ëª… -->
    <header class="mb-8">
        <h1 class="text-3xl md:text-4xl font-extrabold text-blue-800 mb-2 flex items-center">
            <i data-lucide="clipboard-list" class="w-8 h-8 mr-2"></i>
            í†µí•© ì„¤ë¹„/ìì¬ ê´€ë¦¬ ëŒ€ì¥
        </h1>
        <p class="text-gray-600 text-lg">ê¸°ê³„, ì†Œëª¨í’ˆ, ìì¬, ë²•ì • ì£¼ê¸° ê´€ë¦¬ í˜„í™© ëª©ë¡ì…ë‹ˆë‹¤.</p>
    </header>

    <!-- ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ -->
    <main>
        <!-- íƒ­ ë©”ë‰´ -->
        <div class="mb-6 flex border-b border-gray-200 overflow-x-auto custom-scrollbar">
            <button class="tab-button flex-shrink-0 px-4 py-3 text-sm md:text-base font-medium text-gray-600 border-b-2 border-transparent hover:text-blue-600 hover:border-blue-300 transition-colors duration-200 active-tab" onclick="openTab('dashboard', event)">
                <i data-lucide="calculator" class="w-4 h-4 mr-2 inline-block"></i> í˜„í™© ìš”ì•½
            </button>
            <button class="tab-button flex-shrink-0 px-4 py-3 text-sm md:text-base font-medium text-gray-600 border-b-2 border-transparent hover:text-blue-600 hover:border-blue-300 transition-colors duration-200" onclick="openTab('machine', event)">
                <i data-lucide="cog" class="w-4 h-4 mr-2 inline-block"></i> ê¸°ê³„/ì„¤ë¹„ ëª©ë¡
            </button>
            <button class="tab-button flex-shrink-0 px-4 py-3 text-sm md:text-base font-medium text-gray-600 border-b-2 border-transparent hover:text-blue-600 hover:border-blue-300 transition-colors duration-200" onclick="openTab('supplies', event)">
                <i data-lucide="package" class="w-4 h-4 mr-2 inline-block"></i> ì†Œëª¨í’ˆ/ìì¬ ëª©ë¡
            </button>
            <button class="tab-button flex-shrink-0 px-4 py-3 text-sm md:text-base font-medium text-gray-600 border-b-2 border-transparent hover:text-blue-600 hover:border-blue-300 transition-colors duration-200" onclick="openTab('legal', event)">
                <i data-lucide="scale" class="w-4 h-4 mr-2 inline-block"></i> ë²•ì • ì£¼ê¸° ëª©ë¡
            </button>
             <button class="tab-button flex-shrink-0 px-4 py-3 text-sm md:text-base font-medium text-gray-600 border-b-2 border-transparent hover:text-green-600 hover:border-green-300 transition-colors duration-200" onclick="openTab('register', event)">
                <i data-lucide="plus-circle" class="w-4 h-4 mr-2 inline-block"></i> ì‹ ê·œ ë“±ë¡
            </button>
        </div>

        <!-- íƒ­ ë‚´ìš© ì˜ì—­ -->
        <div id="tab-content">

            <!-- 1. í˜„í™© ìš”ì•½ -->
            <div id="dashboard" class="tab-pane active-pane">
                <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <!-- ì¹´ë“œ 1: ì´ ê¸°ê³„/ì„¤ë¹„ ìˆ˜ -->
                    <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-100 transition-transform hover:scale-[1.02]">
                        <div class="flex items-center justify-between">
                            <p class="text-sm font-medium text-gray-500">ì´ ì„¤ë¹„ ìˆ˜</p>
                            <i data-lucide="factory" class="w-6 h-6 text-blue-500"></i>
                        </div>
                        <p class="text-3xl font-bold mt-2" id="total-machines">0</p>
                        <p class="text-xs text-gray-400 mt-1">ìœ í‹¸ë¦¬í‹° ë° ì œì¡° ì¥ë¹„ í†µí•©</p>
                    </div>

                    <!-- ì¹´ë“œ 2: ì ê²€ í•„ìš” ì„¤ë¹„ ìˆ˜ (C/D ë“±ê¸‰) -->
                    <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-100 transition-transform hover:scale-[1.02]">
                        <div class="flex items-center justify-between">
                            <p class="text-sm font-medium text-gray-500">ì£¼ì˜/ê²½ê³  ë“±ê¸‰ ì„¤ë¹„</p>
                            <i data-lucide="alert-triangle" class="w-6 h-6 text-red-500"></i>
                        </div>
                        <p class="text-3xl font-bold mt-2 text-red-600" id="critical-machines">0</p>
                        <p class="text-xs text-gray-400 mt-1">ê¸´ê¸‰ ì¡°ì¹˜ í•„ìš” (C, Dë“±ê¸‰)</p>
                    </div>

                    <!-- ì¹´ë“œ 3: ì†Œëª¨í’ˆ ì¬ê³  ë¶€ì¡± í•­ëª© -->
                    <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-100 transition-transform hover:scale-[1.02]">
                        <div class="flex items-center justify-between">
                            <p class="text-sm font-medium text-gray-500">ì¬ê³  ë¶€ì¡± ì†Œëª¨í’ˆ/ìì¬</p>
                            <i data-lucide="package-minus" class="w-6 h-6 text-orange-500"></i>
                        </div>
                        <p class="text-3xl font-bold mt-2 text-orange-600" id="low-stock-items">0</p>
                        <p class="text-xs text-gray-400 mt-1">ì•ˆì „ ì¬ê³  ì´í•˜ í’ˆëª©</p>
                    </div>

                    <!-- ì¹´ë“œ 4: ë²•ì • ê²€ì‚¬ ì„ë°• í•­ëª© (3ê°œì›” ì´ë‚´) -->
                    <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-100 transition-transform hover:scale-[1.02]">
                        <div class="flex items-center justify-between">
                            <p class="text-sm font-medium text-gray-500">ë²•ì • ê²€ì‚¬ ì„ë°•/ë§Œë£Œ</p>
                            <i data-lucide="calendar-check" class="w-6 h-6 text-amber-500"></i>
                        </div>
                        <p class="text-3xl font-bold mt-2 text-amber-600" id="imminent-legal-checks">0</p>
                        <p class="text-xs text-gray-400 mt-1">3ê°œì›” ì´ë‚´ ì˜ˆì • ë˜ëŠ” ë§Œë£Œ</p>
                    </div>
                </section>
                
                <section class="mt-8 p-6 bg-blue-50 rounded-xl border border-blue-200">
                    <p class="text-lg font-semibold text-blue-700">ğŸ“Œ ìƒì„¸ ëª©ë¡ì€ ìƒë‹¨ì˜ íƒ­ì„ ì„ íƒí•˜ì—¬ í™•ì¸í•´ì£¼ì„¸ìš”.</p>
                </section>
            </div>

            <!-- 2. ê¸°ê³„/ì„¤ë¹„ ëª©ë¡ -->
            <div id="machine" class="tab-pane hidden">
                <h2 class="text-2xl font-bold text-blue-700 mb-4">ì „ì²´ ê¸°ê³„/ì„¤ë¹„ ëª©ë¡</h2>
                <div class="bg-white p-4 rounded-xl shadow-lg border border-gray-100 overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">êµ¬ë¶„</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ê´€ë¦¬ë²ˆí˜¸</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì„¤ë¹„ëª…(êµ­ë¬¸)</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì„¤ì¹˜ ì¥ì†Œ</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì œì¡°ì‚¬/ëª¨ë¸</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ìµœì¢… í‰ê°€</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì ê²€ ì£¼ê¸°</th>
                            </tr>
                        </thead>
                        <tbody id="machine-table-body" class="bg-white divide-y divide-gray-200 text-sm">
                            <!-- ë°ì´í„° ì—†ìŒ -->
                            <tr><td colspan="7" class="text-center py-4 text-gray-500">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 3. ì†Œëª¨í’ˆ/ìì¬ ëª©ë¡ -->
            <div id="supplies" class="tab-pane hidden">
                <h2 class="text-2xl font-bold text-blue-700 mb-4">ì†Œëª¨í’ˆ/ìì¬ ëª©ë¡ ë° ì¬ê³  í˜„í™©</h2>
                <div class="bg-white p-4 rounded-xl shadow-lg border border-gray-100 overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">êµ¬ë¶„</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">í’ˆëª…</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ê·œê²©</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì´ ì¬ê³ </th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì¬ê³  ìƒíƒœ</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">êµì²´ ì£¼ê¸°</th>
                            </tr>
                        </thead>
                        <tbody id="supplies-table-body" class="bg-white divide-y divide-gray-200 text-sm">
                            <!-- ë°ì´í„° ì—†ìŒ -->
                            <tr><td colspan="6" class="text-center py-4 text-gray-500">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 4. ë²•ì • ì£¼ê¸° ëª©ë¡ -->
            <div id="legal" class="tab-pane hidden">
                <h2 class="text-2xl font-bold text-blue-700 mb-4">ë²•ì • ì„ ì„/ê²€ì‚¬/ê³„ì•½ ê´€ë¦¬ í˜„í™©</h2>
                <div class="bg-white p-4 rounded-xl shadow-lg border border-gray-100 overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ë¶„ë¥˜</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ë²•ì • êµ¬ë¶„</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ëŒ€ìƒë¬¼</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì£¼ê¸°</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ìµœê·¼ì¼</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì°¨ê¸°ì¼</th>
                                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ë‚¨ì€ ê¸°ê°„</th>
                            </tr>
                        </thead>
                        <tbody id="legal-table-body" class="bg-white divide-y divide-gray-200 text-sm">
                            <!-- ë°ì´í„° ì—†ìŒ -->
                            <tr><td colspan="7" class="text-center py-4 text-gray-500">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 5. ì‹ ê·œ ë“±ë¡ íƒ­ -->
            <div id="register" class="tab-pane hidden">
                <h2 class="text-2xl font-bold text-green-700 mb-6">ì‹ ê·œ ê´€ë¦¬ í•­ëª© ë“±ë¡</h2>

                <!-- ë“±ë¡ í•­ëª© ì„ íƒ -->
                <div class="mb-6 flex space-x-4 border-b pb-4">
                    <button id="btn-reg-machine" class="reg-type-button px-4 py-2 text-sm font-semibold rounded-lg bg-blue-100 text-blue-700 hover:bg-blue-200 transition-colors" onclick="showRegistrationForm('machine-reg')">
                        <i data-lucide="cog" class="w-4 h-4 mr-2 inline-block"></i> ê¸°ê³„/ì„¤ë¹„
                    </button>
                    <button id="btn-reg-supplies" class="reg-type-button px-4 py-2 text-sm font-semibold rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors" onclick="showRegistrationForm('supplies-reg')">
                        <i data-lucide="package" class="w-4 h-4 mr-2 inline-block"></i> ì†Œëª¨í’ˆ/ìì¬
                    </button>
                    <button id="btn-reg-legal" class="reg-type-button px-4 py-2 text-sm font-semibold rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors" onclick="showRegistrationForm('legal-reg')">
                        <i data-lucide="scale" class="w-4 h-4 mr-2 inline-block"></i> ë²•ì • ì£¼ê¸°
                    </button>
                </div>
                
                <!-- ë“±ë¡ í¼ ì»¨í…Œì´ë„ˆ -->
                <div id="registration-forms-container" class="bg-white p-6 rounded-xl shadow-lg border border-gray-100">
                    <div id="registration-message" class="hidden p-3 mb-4 text-center text-sm font-medium rounded-lg" role="alert"></div>

                    <!-- ê¸°ê³„/ì„¤ë¹„ ë“±ë¡ í¼ -->
                    <form id="machine-reg" class="reg-form" onsubmit="submitRegistration(event, 'machine')">
                        <h3 class="text-xl font-bold mb-4 text-blue-600">ê¸°ê³„/ì„¤ë¹„ ë“±ë¡</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- ê³ ì • í•„ë“œ -->
                            <div>
                                <label for="m-type" class="input-label-style">ì„¤ë¹„ íƒ€ì…/êµ¬ë¶„ <span class="text-red-500">*</span></label>
                                <select id="m-type" name="type" class="input-field-style" onchange="generateDynamicFields(this.value)" required>
                                    <option value="">-- íƒ€ì…ì„ ì„ íƒí•˜ì„¸ìš” --</option>
                                    <option value="Pump">íŒí”„ (Pump)</option>
                                    <option value="AHU">ê³µì¡°ê¸° (AHU/HVAC)</option>
                                    <option value="Reactor">ë°˜ì‘ê¸° (Reactor)</option>
                                    <option value="Tank">ì €ì¥ íƒ±í¬ (Tank)</option>
                                    <option value="General">ê¸°íƒ€ ì¼ë°˜ ì¥ë¹„ (General)</option>
                                </select>
                            </div>
                            <div>
                                <label for="m-mgmtNum" class="input-label-style">ê´€ë¦¬ë²ˆí˜¸ <span class="text-red-500">*</span></label>
                                <input type="text" id="m-mgmtNum" name="mgmtNum" class="input-field-style" required>
                            </div>
                            <div>
                                <label for="m-nameKr" class="input-label-style">ì„¤ë¹„ëª…(êµ­ë¬¸) <span class="text-red-500">*</span></label>
                                <input type="text" id="m-nameKr" name="nameKr" class="input-field-style" required>
                            </div>
                            <div>
                                <label for="m-location" class="input-label-style">ì„¤ì¹˜ ì¥ì†Œ</label>
                                <input type="text" id="m-location" name="location" class="input-field-style">
                            </div>
                            <div>
                                <label for="m-manufacturer" class="input-label-style">ì œì¡°ì‚¬</label>
                                <input type="text" id="m-manufacturer" name="manufacturer" class="input-field-style">
                            </div>
                            <div>
                                <label for="m-finalGrade" class="input-label-style">ìµœì¢… í‰ê°€ ë“±ê¸‰</label>
                                <select id="m-finalGrade" name="finalGrade" class="input-field-style">
                                    <option value="A">A (ì–‘í˜¸)</option>
                                    <option value="B">B (ë³´í†µ)</option>
                                    <option value="C">C (ì£¼ì˜)</option>
                                    <option value="D">D (ê²½ê³ )</option>
                                </select>
                            </div>
                            <div>
                                <label for="m-checkPeriod" class="input-label-style">ì ê²€ ì£¼ê¸°</label>
                                <input type="text" id="m-checkPeriod" name="checkPeriod" class="input-field-style" placeholder="ì˜ˆ: 1íšŒ/ë…„, ì›” ì ê²€">
                            </div>
                        </div>

                        <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  ìƒì„¸ í•„ë“œ ì˜ì—­ -->
                        <div id="dynamic-fields-machine" class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6 pt-4 border-t border-gray-200">
                            <p class="text-gray-500 col-span-2">ì„¤ë¹„ íƒ€ì…ì„ ì„ íƒí•˜ë©´ í•´ë‹¹ í•­ëª©ì— ë§ëŠ” ìƒì„¸ ìŠ¤í™ ì…ë ¥ í•„ë“œê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</p>
                        </div>
                        
                        <div class="mt-6 text-right">
                            <button type="submit" class="px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors shadow-md">
                                ê¸°ê³„/ì„¤ë¹„ ë“±ë¡
                            </button>
                        </div>
                    </form>

                    <!-- ì†Œëª¨í’ˆ/ìì¬ ë“±ë¡ í¼ (ì´ì „ê³¼ ë™ì¼) -->
                    <form id="supplies-reg" class="reg-form hidden" onsubmit="submitRegistration(event, 'supplies')">
                        <h3 class="text-xl font-bold mb-4 text-green-600">ì†Œëª¨í’ˆ/ìì¬ ë“±ë¡</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="s-type" class="input-label-style">êµ¬ë¶„ (ì†Œëª¨í’ˆ/ìì¬) <span class="text-red-500">*</span></label>
                                <select id="s-type" name="type" class="input-field-style" required>
                                    <option value="ì†Œëª¨í’ˆ">ì†Œëª¨í’ˆ</option>
                                    <option value="ìì¬">ìì¬</option>
                                </select>
                            </div>
                            <div>
                                <label for="s-name" class="input-label-style">í’ˆëª… <span class="text-red-500">*</span></label>
                                <input type="text" id="s-name" name="name" class="input-field-style" required>
                            </div>
                            <div>
                                <label for="s-spec" class="input-label-style">ê·œê²©/ëª¨ë¸</label>
                                <input type="text" id="s-spec" name="spec" class="input-field-style">
                            </div>
                            <div>
                                <label for="s-totalStock" class="input-label-style">ì´ ì¬ê³  (ìˆ˜ëŸ‰) <span class="text-red-500">*</span></label>
                                <input type="number" id="s-totalStock" name="totalStock" class="input-field-style" min="0" required>
                            </div>
                            <div>
                                <label for="s-safeStock" class="input-label-style">ì•ˆì „ ì¬ê³  ê¸°ì¤€</label>
                                <input type="number" id="s-safeStock" name="safeStock" class="input-field-style" min="0">
                            </div>
                            <div>
                                <label for="s-period" class="input-label-style">êµì²´/ì ê²€ ì£¼ê¸°</label>
                                <input type="text" id="s-period" name="period" class="input-field-style" placeholder="ì˜ˆ: 1íšŒ/ì›”, ìˆ˜ì‹œ">
                            </div>
                        </div>
                        <div class="mt-6 text-right">
                            <button type="submit" class="px-6 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-colors shadow-md">
                                ì†Œëª¨í’ˆ/ìì¬ ë“±ë¡
                            </button>
                        </div>
                    </form>

                    <!-- ë²•ì • ì£¼ê¸° ë“±ë¡ í¼ (ì´ì „ê³¼ ë™ì¼) -->
                    <form id="legal-reg" class="reg-form hidden" onsubmit="submitRegistration(event, 'legal')">
                        <h3 class="text-xl font-bold mb-4 text-amber-600">ë²•ì • ì£¼ê¸° í•­ëª© ë“±ë¡</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="l-type" class="input-label-style">ë²•ì • êµ¬ë¶„ <span class="text-red-500">*</span></label>
                                <input type="text" id="l-type" name="type" class="input-field-style" required placeholder="ì˜ˆ: ì •ê¸°ê²€ì‚¬, ì•ˆì „ê´€ë¦¬ì ì„ ì„">
                            </div>
                            <div>
                                <label for="l-target" class="input-label-style">ëŒ€ìƒë¬¼/ëŒ€ìƒ</label>
                                <input type="text" id="l-target" name="target" class="input-field-style" placeholder="ì˜ˆ: íŠ¹ì •ê°€ìŠ¤ì‚¬ìš©ì‹œì„¤, OOOí˜¸ ëƒ‰ë™ê¸°">
                            </div>
                            <div>
                                <label for="l-period" class="input-label-style">ì£¼ê¸°</label>
                                <input type="text" id="l-period" name="period" class="input-field-style" placeholder="ì˜ˆ: 1ë…„, 3ë…„">
                            </div>
                            <div>
                                <label for="l-recentDate" class="input-label-style">ìµœê·¼ ê²€ì‚¬ì¼</label>
                                <input type="date" id="l-recentDate" name="recentDate" class="input-field-style">
                            </div>
                            <div>
                                <label for="l-nextDate" class="input-label-style">ì°¨ê¸° ê²€ì‚¬ì¼ <span class="text-red-500">*</span></label>
                                <input type="date" id="l-nextDate" name="nextDate" class="input-field-style" required>
                            </div>
                            <div>
                                <label for="l-category" class="input-label-style">ë¶„ë¥˜ (ë²•ê·œ)</label>
                                <input type="text" id="l-category" name="category" class="input-field-style" placeholder="ì˜ˆ: ê°€ìŠ¤, ì—ë„ˆì§€, ì†Œë°©">
                            </div>
                        </div>
                        <div class="mt-6 text-right">
                            <button type="submit" class="px-6 py-2 bg-amber-600 text-white font-semibold rounded-lg hover:bg-amber-700 transition-colors shadow-md">
                                ë²•ì • ì£¼ê¸° ë“±ë¡
                            </button>
                        </div>
                    </form>
                </div>
            </div>

        </div>
    </main>
    
    <script>
        // Lucide Icons ì´ˆê¸°í™”
        lucide.createIcons();
        
        // ì„¤ë¹„ íƒ€ì…ë³„ ìƒì„¸ ìŠ¤í™ ì •ì˜ (í•µì‹¬ ë¡œì§)
        const MACHINE_SCHEMAS = {
            Pump: [
                { id: 'm-capa', label: 'ìš©ëŸ‰', type: 'text', placeholder: 'ì˜ˆ: 6mÂ³/hr' },
                { id: 'm-power', label: 'ë™ë ¥ (kW)', type: 'number', placeholder: 'ì˜ˆ: 2.2' },
                { id: 'm-motor', label: 'ëª¨í„° ì œì¡°ì‚¬/ëª¨ë¸', type: 'text', placeholder: 'ì˜ˆ: ë‘í¬íŒí”„ XRL5-9' },
                { id: 'm-pressure', label: 'ì–‘ì •/ì••ë ¥ (mH)', type: 'text', placeholder: 'ì˜ˆ: 70mH' }
            ],
            AHU: [
                { id: 'm-airflow', label: 'í’ëŸ‰ (CMH)', type: 'text', placeholder: 'ì˜ˆ: 10,000 CMH' },
                { id: 'm-filter', label: 'í•„í„° ì¢…ë¥˜', type: 'text', placeholder: 'ì˜ˆ: Pre, Medium, Hepa' },
                { id: 'm-temp', label: 'ì˜¨ë„ ë²”ìœ„', type: 'text', placeholder: 'ì˜ˆ: 15 ~ 25â„ƒ' },
                { id: 'm-zone', label: 'ì ìš© êµ¬ì—­', type: 'text', placeholder: 'ì˜ˆ: GMP 1Zone' }
            ],
            Reactor: [
                { id: 'm-volume', label: 'ìš©ëŸ‰ (L)', type: 'number', placeholder: 'ì˜ˆ: 500' },
                { id: 'm-tempRange', label: 'ì˜¨ë„ ì‚¬ìš© ë²”ìœ„', type: 'text', placeholder: 'ì˜ˆ: -20 ~ 150â„ƒ' },
                { id: 'm-pressureRange', label: 'ìµœëŒ€ ì••ë ¥', type: 'text', placeholder: 'ì˜ˆ: 5 bar' },
                { id: 'm-agitator', label: 'êµë°˜ê¸° ì‚¬ì–‘', type: 'text', placeholder: 'ì˜ˆ: 1HP, 120 RPM' }
            ],
            Tank: [
                { id: 'm-tankVolume', label: 'ìš©ëŸ‰ (mÂ³ ë˜ëŠ” L)', type: 'text', placeholder: 'ì˜ˆ: 10 mÂ³' },
                { id: 'm-material', label: 'ì¬ì§ˆ', type: 'text', placeholder: 'ì˜ˆ: SUS316L, PE' },
                { id: 'm-fluid', label: 'ì €ì¥ ìœ ì²´', type: 'text', placeholder: 'ì˜ˆ: ì •ì œìˆ˜, íìˆ˜' },
                { id: 'm-size', label: 'í¬ê¸° (SIZE)', type: 'text', placeholder: 'ì˜ˆ: ID2200 x 3100H' }
            ],
            General: [
                { id: 'm-specNote', label: 'íŠ¹ì´/ìƒì„¸ ìŠ¤í™', type: 'textarea', placeholder: 'ì¼ë°˜ ì¥ë¹„ì˜ ìƒì„¸ ìŠ¤í™ì„ ììœ ë¡­ê²Œ ì…ë ¥í•˜ì„¸ìš”.' }
            ]
        };

        // íƒ­ ì „í™˜ í•¨ìˆ˜
        function openTab(tabId, event) {
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.add('hidden');
                pane.classList.remove('active-pane');
            });
            document.getElementById(tabId).classList.remove('hidden');
            document.getElementById(tabId).classList.add('active-pane');

            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active-tab', 'text-blue-600', 'border-blue-600', 'text-green-600', 'border-green-600');
                button.classList.add('text-gray-600', 'border-transparent');
            });
            
            const target = event ? event.currentTarget : document.querySelector(`.tab-button[onclick*="'${tabId}'"]`);
            if (target) {
                 if (tabId === 'register') {
                    target.classList.add('text-green-600', 'border-green-600');
                } else {
                    target.classList.add('text-blue-600', 'border-blue-600');
                }
                target.classList.remove('text-gray-600', 'border-transparent');
            }

            // 'ì‹ ê·œ ë“±ë¡' íƒ­ìœ¼ë¡œ ì „í™˜ ì‹œ ê¸°ë³¸ í¼(ê¸°ê³„/ì„¤ë¹„) í‘œì‹œ
            if (tabId === 'register') {
                showRegistrationForm('machine-reg');
            }
        }

        // ë“±ë¡ í¼ ì „í™˜ í•¨ìˆ˜
        function showRegistrationForm(formId) {
            document.querySelectorAll('.reg-form').forEach(form => {
                form.classList.add('hidden');
            });
            document.getElementById(formId).classList.remove('hidden');

            document.querySelectorAll('.reg-type-button').forEach(button => {
                button.classList.remove('bg-blue-100', 'text-blue-700', 'bg-green-100', 'text-green-700', 'bg-amber-100', 'text-amber-700');
                button.classList.add('bg-gray-100', 'text-gray-700');
            });

            const buttonId = formId.replace('-reg', '');
            const targetButton = document.getElementById(`btn-reg-${buttonId}`);
            if (targetButton) {
                 if (buttonId === 'machine') {
                    targetButton.classList.remove('bg-gray-100', 'text-gray-700');
                    targetButton.classList.add('bg-blue-100', 'text-blue-700');
                    // ê¸°ê³„ ë“±ë¡ í¼ì´ ì„ íƒë˜ë©´ ë™ì  í•„ë“œë¥¼ ë‹¤ì‹œ ìƒì„± (í˜¹ì‹œ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ì„ ê²½ìš° ëŒ€ë¹„)
                    const machineType = document.getElementById('m-type').value;
                    generateDynamicFields(machineType);
                } else if (buttonId === 'supplies') {
                    targetButton.classList.remove('bg-gray-100', 'text-gray-700');
                    targetButton.classList.add('bg-green-100', 'text-green-700');
                } else if (buttonId === 'legal') {
                    targetButton.classList.remove('bg-gray-100', 'text-gray-700');
                    targetButton.classList.add('bg-amber-100', 'text-amber-700');
                }
            }
            
            // ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
            document.getElementById('registration-message').classList.add('hidden');
        }

        // ë™ì  í•„ë“œ ìƒì„± í•¨ìˆ˜ (í•µì‹¬ ë¡œì§)
        function generateDynamicFields(selectedType) {
            const container = document.getElementById('dynamic-fields-machine');
            container.innerHTML = ''; // ê¸°ì¡´ í•„ë“œ ì´ˆê¸°í™”

            if (!selectedType || selectedType === 'General') {
                 // General íƒ€ì…ì´ê±°ë‚˜ ì„ íƒ ì•ˆ ëœ ê²½ìš° ê¸°ë³¸ ë©”ì‹œì§€ í‘œì‹œ
                 const defaultText = selectedType ? 'ì¼ë°˜ ì¥ë¹„ì˜ íŠ¹ì´/ìƒì„¸ ìŠ¤í™ì„ ì…ë ¥í•˜ì„¸ìš”.' : 'ì„¤ë¹„ íƒ€ì…ì„ ì„ íƒí•˜ë©´ í•´ë‹¹ í•­ëª©ì— ë§ëŠ” ìƒì„¸ ìŠ¤í™ ì…ë ¥ í•„ë“œê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.';
                 container.innerHTML = `<p class="text-gray-500 col-span-2">${defaultText}</p>`;
            }


            const fields = MACHINE_SCHEMAS[selectedType] || MACHINE_SCHEMAS['General'];
            
            if (selectedType && selectedType !== 'General') {
                 // êµ¬ë¶„ì„ 
                 const divider = document.createElement('div');
                 divider.className = 'col-span-2 text-lg font-semibold text-gray-700 mt-2 mb-2';
                 divider.textContent = `${fields[0].label.split(' ')[0]} ìƒì„¸ ìŠ¤í™ (${selectedType})`;
                 container.appendChild(divider);
            }

            fields.forEach(field => {
                const div = document.createElement('div');
                div.className = 'flex flex-col';
                
                const label = document.createElement('label');
                label.htmlFor = field.id;
                label.className = 'input-label-style';
                label.textContent = field.label;
                
                let input;
                if (field.type === 'textarea') {
                    input = document.createElement('textarea');
                    input.rows = 3;
                } else {
                    input = document.createElement('input');
                    input.type = field.type;
                    input.min = (field.type === 'number' ? '0' : undefined);
                }
                
                input.id = field.id;
                input.name = field.id.replace('m-', 'spec_'); // ë°ì´í„° í‚¤ë¥¼ 'spec_' ì ‘ë‘ì‚¬ë¡œ í†µì¼
                input.className = 'input-field-style';
                input.placeholder = field.placeholder || '';
                
                div.appendChild(label);
                div.appendChild(input);
                container.appendChild(div);
            });
        }


        // ë“±ë¡ ì²˜ë¦¬ í•¨ìˆ˜
        function submitRegistration(event, type) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const data = { type: type };
            
            for (let [key, value] of formData.entries()) {
                // ë™ì  í•„ë“œëŠ” key ì´ë¦„ì´ spec_ ë¡œ ì‹œì‘í•¨
                if (key.startsWith('spec_')) {
                    // ê¸°ê³„/ì„¤ë¹„ì˜ ìƒì„¸ ìŠ¤í™ì€ ë³„ë„ì˜ ê°ì²´ë¡œ ë¬¶ì–´ ì €ì¥
                    if (!data.dynamicSpecs) {
                        data.dynamicSpecs = {};
                    }
                    // spec_capa -> capa ë¡œ í‚¤ ì •ë¦¬
                    data.dynamicSpecs[key.replace('spec_', '')] = value;
                } else {
                    data[key] = value;
                }
            }

            const messageBox = document.getElementById('registration-message');
            messageBox.classList.remove('hidden', 'bg-red-100', 'text-red-700', 'bg-green-100', 'text-green-700');

            try {
                // ë“±ë¡ ì„±ê³µ ì‹œ ì½˜ì†”ì— ì¶œë ¥
                console.log(`[${type.toUpperCase()} ë“±ë¡ ë°ì´í„°]`, data);

                messageBox.classList.add('bg-green-100', 'text-green-700');
                messageBox.textContent = `âœ… ${type.toUpperCase()} í•­ëª©ì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤! (ë°ì´í„°ëŠ” ì½˜ì†”ì— ì¶œë ¥ë¨)`;
                
                // í¼ ì´ˆê¸°í™” ë° ë™ì  í•„ë“œ ì´ˆê¸°í™”
                form.reset();
                if (type === 'machine') {
                     generateDynamicFields(''); // ê¸°ê³„ í¼ ì´ˆê¸°í™” ì‹œ ë™ì  í•„ë“œë„ ì´ˆê¸°í™”
                }

            } catch (error) {
                console.error(`[${type.toUpperCase()} ë“±ë¡ ì˜¤ë¥˜]`, error);
                messageBox.classList.add('bg-red-100', 'text-red-700');
                messageBox.textContent = `âŒ ${type.toUpperCase()} ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`;
            }

        }

        // --- ë°ì´í„° ì´ˆê¸°í™” í•¨ìˆ˜ (ë°ì´í„° ë¹„ì›€ ìƒíƒœ ìœ ì§€) ---
        function initializeCardValues() {
            document.getElementById('total-machines').textContent = '0';
            document.getElementById('critical-machines').textContent = '0';
            document.getElementById('low-stock-items').textContent = '0';
            document.getElementById('imminent-legal-checks').textContent = '0';
        }

        function initializeTables() {
            const emptyRow = '<tr><td colspan="7" class="text-center py-4 text-gray-500">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
            document.getElementById('machine-table-body').innerHTML = emptyRow;
            document.getElementById('supplies-table-body').innerHTML = '<tr><td colspan="6" class="text-center py-4 text-gray-500">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
            document.getElementById('legal-table-body').innerHTML = emptyRow;
        }

        // ì´ˆê¸°í™”
        async function initDashboard() {
            initializeCardValues();
            initializeTables();

            window.isDataLoaded = true;
            openTab('dashboard', null); 
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™”
        window.onload = function() {
            initDashboard();
        };

    </script>
</body>
</html>
